#!/usr/bin/env python3
"""
ESQs CLI Error Handler
Redirects users who try to run ESQs as a command-line tool to the proper PWA access methods
"""

import sys
import os
import subprocess
import platform

def show_esqs_branding():
    print("\n" + "="*70)
    print("â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—")
    print("â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â•â•â•â•")
    print("â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—")
    print("â–ˆâ–ˆâ•”â•â•â•   â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–„â–„ â–ˆâ–ˆâ•‘ â•šâ•â•â•â•â–ˆâ–ˆâ•‘")
    print("â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘")
    print("â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•â• â•šâ•â•â–€â–€â•â•  â•šâ•â•â•â•â•â•â•")
    print("\nEnhanced Synthesized Quintessential System")
    print("Legal Intelligence Platform")
    print("="*70)

def show_cli_error():
    print("\nâŒ ERROR: ESQs is NOT a Command-Line Tool!")
    print("\nğŸŒ ESQs is a Progressive Web App (PWA) that runs in your browser.")
    print("   It provides a visual interface for legal intelligence work.")

def show_correct_access_methods():
    print("\nâœ… CORRECT ACCESS METHODS:")
    print("\n1. ğŸš€ LAUNCHER SCRIPTS (Recommended):")
    
    system = platform.system().lower()
    if system == "windows":
        print("   â€¢ launch-esqs.bat --local    (Command Prompt)")
        print("   â€¢ .\\launch-esqs.ps1 -Local   (PowerShell)")
    else:
        print("   â€¢ ./launch-esqs.sh --local   (Local development)")
        print("   â€¢ ./launch-esqs.sh --web     (Online version)")
    
    print("\n2. ğŸŒ DIRECT WEB ACCESS:")
    print("   â€¢ https://bcls-esqs.github.io/boyack-christiansen-Enhanced-Synthizied-Quintessential-System-ESQs/")
    
    print("\n3. ğŸ“± PWA INSTALLATION:")
    print("   â€¢ Open ESQs in browser â†’ Click install icon (âŠ•) â†’ Install as app")
    
    print("\n4. ğŸ§ª INTEGRATION TESTING:")
    if system == "windows":
        print("   â€¢ launch-esqs.bat --test")
    else:
        print("   â€¢ ./launch-esqs.sh --test")

def show_help():
    print("\nğŸ“– HELP & DOCUMENTATION:")
    print("   â€¢ Setup Guide: ./SETUP.md")
    print("   â€¢ Integration Testing: Built-in test suite")
    print("   â€¢ Synthia AI: Available in web interface")
    print("   â€¢ API Configuration: Set keys in browser console")

def try_launch_esqs():
    """Attempt to launch ESQs using the appropriate launcher script"""
    system = platform.system().lower()
    script_dir = os.path.dirname(os.path.abspath(__file__))
    
    print("\nğŸš€ Attempting to launch ESQs properly...")
    
    try:
        if system == "windows":
            # Try PowerShell first, then batch
            launchers = ["launch-esqs.ps1", "launch-esqs.bat"]
            for launcher in launchers:
                launcher_path = os.path.join(script_dir, launcher)
                if os.path.exists(launcher_path):
                    if launcher.endswith('.ps1'):
                        subprocess.run(['powershell', '-ExecutionPolicy', 'Bypass', '-File', launcher_path, '-Local'], check=False)
                    else:
                        subprocess.run([launcher_path, '--local'], check=False)
                    return True
        else:
            # Unix-like systems
            launcher_path = os.path.join(script_dir, "launch-esqs.sh")
            if os.path.exists(launcher_path):
                # Make sure it's executable
                os.chmod(launcher_path, 0o755)
                subprocess.run([launcher_path, '--local'], check=False)
                return True
        
        return False
    except Exception as e:
        print(f"âš ï¸  Could not auto-launch ESQs: {e}")
        return False

def main():
    show_esqs_branding()
    show_cli_error()
    show_correct_access_methods()
    show_help()
    
    # Check if we're in the right directory and can auto-launch
    if os.path.exists("launch-esqs.sh") or os.path.exists("launch-esqs.bat") or os.path.exists("launch-esqs.ps1"):
        print("\nğŸ¤” Would you like me to launch ESQs properly for you? (y/n): ", end="")
        try:
            response = input().lower().strip()
            if response in ['y', 'yes', '']:
                if try_launch_esqs():
                    print("âœ… ESQs launch initiated! Check your browser.")
                else:
                    print("âŒ Auto-launch failed. Please use the launcher scripts manually.")
            else:
                print("ğŸ‘ Use the launcher scripts above to access ESQs.")
        except KeyboardInterrupt:
            print("\nğŸ‘‹ Use the launcher scripts to access ESQs.")
    else:
        print("\nğŸ’¡ Make sure you're in the ESQs directory and use the launcher scripts.")
    
    print("\n" + "="*70)

if __name__ == "__main__":
    main()